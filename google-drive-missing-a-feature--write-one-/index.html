<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Google Drive missing a feature? Write one.</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/main/css/main.css?v=780b19055e">
    <link rel="stylesheet" type="text/css" href="../assets/main/css/prism.css?v=780b19055e"> 

    <link rel="canonical" href="https://medium.com/@wdziemia/google-drive-missing-a-feature-write-one-563a2ae64ba6">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="Wojciech Dziemianczyk">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Google Drive missing a feature? Write one.">
    <meta property="og:description" content="If you‚Äôre not familiar with Google Scripts, check it out. Its pretty cool tool to let you automate tasks for various Google services. When‚Ä¶">
    <meta property="og:url" content="https://medium.com/@wdziemia/google-drive-missing-a-feature-write-one-563a2ae64ba6">
    <meta property="article:published_time" content="2016-07-27T00:00:00.000Z">
    <meta property="article:modified_time" content="2020-12-23T18:05:30.000Z">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Google Drive missing a feature? Write one.">
    <meta name="twitter:description" content="If you‚Äôre not familiar with Google Scripts, check it out. Its pretty cool tool to let you automate tasks for various Google services. When‚Ä¶">
    <meta name="twitter:url" content="https://medium.com/@wdziemia/google-drive-missing-a-feature-write-one-563a2ae64ba6">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Walter Dziemianczyk">
    <meta name="twitter:site" content="@wdziemia">
    <meta name="twitter:creator" content="@wdziemia">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Wojciech Dziemianczyk",
        "url": "//wdziemia.github.io/",
        "logo": {
            "@type": "ImageObject",
            "url": "//wdziemia.github.io/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "Walter Dziemianczyk",
        "image": {
            "@type": "ImageObject",
            "url": "//wdziemia.github.io/content/images/2020/12/Group-1.png",
            "width": 433,
            "height": 433
        },
        "url": "//wdziemia.github.io/author/wdziemia/",
        "sameAs": [
            "https://twitter.com/wdziemia"
        ]
    },
    "headline": "Google Drive missing a feature? Write one.",
    "url": "//wdziemia.github.io/google-drive-missing-a-feature--write-one-/",
    "datePublished": "2016-07-27T00:00:00.000Z",
    "dateModified": "2020-12-23T18:05:30.000Z",
    "description": "\nIf you‚Äôre not familiar with Google Scripts, check it out. Its pretty cool tool to let you automate tasks for various Google services. When‚Ä¶\n",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "//wdziemia.github.io/"
    }
}
    </script>

    <meta name="generator" content="Ghost 3.40">
    <link rel="alternate" type="application/rss+xml" title="Wojciech Dziemianczyk" href="../rss/index.rss">

</head>
<body class="is-preload post-template">

    <div id="wrapper">
        <main id="main">
            <div class="inner">

                
<section>

    <header class="main content">
        <span class="date">July 27, 2016</span>
        <h1>Google Drive missing a feature? Write one.</h1>
            <p class="content">
If you‚Äôre not familiar with Google Scripts, check it out. Its pretty cool tool to let you automate tasks for various Google services. When‚Ä¶
</p>
    </header>


    <div class="content">
        <p>If you‚Äôre not familiar with Google Scripts, <a href="https://www.google.com/script/start/">check it out</a>. Its pretty cool tool to let you automate tasks for various Google services. When I signed up for the LIRR train alert email service, I quickly found out that they come in fairly often. I had a filter that applied a label and skipped inbox which worked well, the only thing is, I would have to go in and manually delete after they accumulated. This is when I used my Google-fu to find a way of automating that task. Once I found Google Scripts, I wrote a short script to delete emails after 24 hours who were tagged with a ‚ÄúLIRR‚Äù label. Perfectüëå.</p><hr><p>So¬†‚Ä¶ guess what? You can‚Äôt get email notifications for specific folders on Google Drive.</p><figure class="kg-card kg-image-card"><img src="../content/images/downloaded_images/Google-Drive-missing-a-feature--Write-one-/1-iZi01hWPf4C1ouKDAtJxHg.gif" class="kg-image" alt></figure><p>Right Ryan Reynolds, what if we could? What if my buddy Jimmy-Bob wanted to add a few files of shark-kittens to a shared folder of ours and not have to tell me manually(üòµ). No dice‚Ä¶..UNTIL NOW!</p><p>So basic idea: Create a place to a read/write a time stamp. If a file was updated after that timestamp, send an email to a list of email addresses. Simple enough, lets do this üòé.</p><hr><pre><code class="language-javascript">var folderName = ‚Äòkittens‚Äô; 
var dataStorefileName = ‚Äòlast_updated_kittens_store‚Äô; 
var emails = [‚ÄòfirstEmail123@example.com‚Äô, ‚ÄòotherEmail124@example.com‚Äô];</code></pre><p>First, we define some hardcoded values where <strong>folderName </strong>is the folder we are checking, <strong>dataStorefileName </strong>is the file where we store our last-checked timestamp, and <strong>emails </strong>is a list emails to send an update to.</p><pre><code class="language-javascript">var storeFiles = DriveApp.getFilesByName(dataStorefileName); 
var currentTime = new Date().getTime();  
var lastCheckedDate = new Date(0);

if (storeFiles.hasNext()){    
  var storeFile = storeFiles.next();    
  var content = Number(storeFile.getBlob().getDataAsString());      
  lastCheckedDate = new Date(content);      
  storeFile.setContent(currentTime);  
} else {    
  DriveApp.createFile(dataStorefileName, currentTime);    
  return;  
}</code></pre><p>Next, we check if <strong>dataStorefileName </strong>exists, if so then we read in the time from the file. When then update the file for the next time the script executes. If the file does not exist, we write a new file with the current time and finish the script (most likely first run).</p><pre><code class="language-javascript">var emailBody = ‚ÄòNew files have been added to ‚Äò + folderName + ‚Äò. Files added: \n\n‚Äô; 
var folder = DriveApp.getFoldersByName(folderName); 
while (folder.hasNext()) { 
  var kittensFolder = folder.next(); 
  var files = kittensFolder.getFiles(); 
  var updatedFilesFormatted = ‚Äò‚Äô; 

  // If there are files in the folder 
  if (files.hasNext()){ 
    while (files.hasNext()){ 
      var file = files.next(); 
      // And if the lastUpdated date is greater than the lastCheckedDate 
      if (file.getLastUpdated() &gt;= lastCheckedDate){ 
        // Format &amp; appened to a String 
        updatedFilesFormatted = updatedFilesFormatted.concat(file.getName() + ‚Äò\n‚Äô); 
      } 
    } 

    // If our formatted string is not empty, email the list to emails     
    if (updatedFilesFormatted.length &gt; 0){ 
      for (var i = 0; i &lt; emails.length; i++){    
        GmailApp.sendEmail(emails[i], folderName + ‚Äò was updated‚Äô, emailBody.concat(updatedFilesFormatted)); 
      } 
    } 
  } 
  break; 
}</code></pre><p>Lastly, we iterate through all the files. If <strong>File.getLastUpdated </strong>returns a value greater or equal to <strong>lastCheckedDate</strong>, append the file-name to a string. We then check to see to see if <strong>updatedFilesFormatted </strong>is empty. If its not, send an email to each of the email address in the <strong>emails</strong> array.</p><hr><p>Thats it! Next step would be the time trigger. You can add one through Resouces &gt; Current Project‚Äôs Triggers in the gscript dev window. In this case we would use a<strong> time-based trigger </strong>with whatever interval you want. This time based trigger means that the script will execute at every interval you specify (i.e. every 1 min, 5 min, 1 hour, etc..).</p><p>You can view the full source on my<strong> </strong><a href="https://gist.github.com/wdziemia/c45a59d13510fcd2f273f8e0583cb8d9"><strong>Github</strong></a><strong>. </strong>Note, I wrote this in about an hour so its far from perfect, but hey, thats why we iterate.</p><p>

</p><figure class="kg-card kg-image-card"><img src="../content/images/downloaded_images/Google-Drive-missing-a-feature--Write-one-/1-Mjpt0QLY7Vwa8V2ygpUTGA.gif" class="kg-image" alt></figure>
    </div>


    <footer class="post-footer">
        <div><a href="//twitter.com/wdziemia">‚Äî @wdziemia</a></div>
    </footer>
    
    

    


</section>

<script>
    var images = document.querySelectorAll('.kg-gallery-image img');
    images.forEach(function (image) {
        var container = image.closest('.kg-gallery-image');
        var width = image.attributes.width.value;
        var height = image.attributes.height.value;
        var ratio = width / height;
        container.style.flex = ratio + ' 1 0%';
    })
</script>


            </div>
        </main>

        <div id="sidebar">
    <div class="inner">

              
                <section class="author-header">
                        <img class="author-profile-image" src="../content/images/2020/12/Group-1.png" alt="Walter Dziemianczyk">
                    <h5><a href="../author/wdziemia/index.html">Walter Dziemianczyk</a></h5>       
                        <p class="content">Senior Software Engineer <span class="bull">‚Ä¢</span> <a href="//wdziemia.github.io/google-drive-missing-a-feature--write-one-/www.twiter.com/NYTimes">@NYTimes</a></p>

                    <div class="author-location icon fa-map-pin">New York, New York</div>

                </section>
            

            <nav id="menu">
    <header class="major">
        <h2>Menu</h2>
    </header>
    <ul class="links">
        <li class="nav-home "><a href="../index.html">Home</a></li>
    </ul>
</nav>

        <section id="menu">
            <header class="major">
                <h2>Links</h2>
            </header>
            <ul class="links">
                <li><a href="https://github.com/wdziemia">Github</a></li>
                <li><a href="https://www.linkedin.com/in/walter-dziemianczyk-3308035b/">LinkedIn</a></li>
                <li><a href="https://twitter.com/wdziemia">Twitter</a></li>
                <li><a href="https://feedly.com/i/subscription/feed///wdziemia.github.io/rss/index.rss">Linkify</a></li>
            </ul>
        </section>

        <section id="menu">
            <header class="major">
                <h2>Projects</h2>
            </header>
            <ul class="links">
                <li><a href="https://window.dziemia.com">Window VQA</a></li>
                <li><a href="https://github.com/wdziemia/wdziemia.github.io">Blog</a></li>
            </ul>
        </section>

        <footer id="footer">
            <p class="copyright">¬© 2020 Wojciech Dziemianczyk
        </p></footer>

    </div>
</div>

    </div>

    <script src="../assets/main/js/jquery.min.js?v=780b19055e"></script>
    <script src="../assets/main/js/browser.min.js?v=780b19055e"></script>
    <script src="../assets/main/js/breakpoints.min.js?v=780b19055e"></script>
    <script src="../assets/main/js/util.js?v=780b19055e"></script>
    <script src="../assets/main/js/main.js?v=780b19055e"></script>
    <script src="../assets/main/js/prism.js?v=780b19055e"></script>

    

</body>
</html>