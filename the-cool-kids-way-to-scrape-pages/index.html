<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Scraping a Feature Together</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/main/css/main.css?v=fc55173e29">
    <link rel="stylesheet" type="text/css" href="../assets/main/css/prism.css?v=fc55173e29"> 

    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="Wojciech Dziemianczyk">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Scraping a Feature Together">
    <meta property="og:description" content="YQL (Yahoo Query Language) allows you to do amazing things, and has many feeds for a developer to play with. Explore how we use it in Peak Stocks!">
    <meta property="og:url" content="//wdziemia.github.io/the-cool-kids-way-to-scrape-pages/">
    <meta property="og:image" content="https://images.unsplash.com/photo-1516259762381-22954d7d3ad2?crop=entropy&amp;cs=tinysrgb&amp;fit=max&amp;fm=jpg&amp;ixid=MXwxMTc3M3wwfDF8c2VhcmNofDZ8fGNvZGV8ZW58MHx8fA&amp;ixlib=rb-1.2.1&amp;q=80&amp;w=2000">
    <meta property="article:published_time" content="2013-03-21T12:24:00.000Z">
    <meta property="article:modified_time" content="2020-12-24T00:56:50.000Z">
    <meta property="article:tag" content="YQL">
    <meta property="article:tag" content="Scraping">
    <meta property="article:tag" content="Data">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Scraping a Feature Together">
    <meta name="twitter:description" content="YQL (Yahoo Query Language) allows you to do amazing things, and has many feeds for a developer to play with. Explore how we use it in Peak Stocks!">
    <meta name="twitter:url" content="//wdziemia.github.io/the-cool-kids-way-to-scrape-pages/">
    <meta name="twitter:image" content="https://images.unsplash.com/photo-1516259762381-22954d7d3ad2?crop=entropy&amp;cs=tinysrgb&amp;fit=max&amp;fm=jpg&amp;ixid=MXwxMTc3M3wwfDF8c2VhcmNofDZ8fGNvZGV8ZW58MHx8fA&amp;ixlib=rb-1.2.1&amp;q=80&amp;w=2000">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Walter Dziemianczyk">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="YQL, Scraping, Data">
    <meta name="twitter:site" content="@wdziemia">
    <meta name="twitter:creator" content="@wdziemia">
    <meta property="og:image:width" content="2000">
    <meta property="og:image:height" content="1306">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Wojciech Dziemianczyk",
        "url": "//wdziemia.github.io/",
        "logo": {
            "@type": "ImageObject",
            "url": "//wdziemia.github.io/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "Walter Dziemianczyk",
        "image": {
            "@type": "ImageObject",
            "url": "//wdziemia.github.io/content/images/2020/12/3921079.jpeg",
            "width": 433,
            "height": 433
        },
        "url": "//wdziemia.github.io/author/wdziemia/",
        "sameAs": [
            "https://twitter.com/wdziemia"
        ]
    },
    "headline": "Scraping a Feature Together",
    "url": "//wdziemia.github.io/the-cool-kids-way-to-scrape-pages/",
    "datePublished": "2013-03-21T12:24:00.000Z",
    "dateModified": "2020-12-24T00:56:50.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://images.unsplash.com/photo-1516259762381-22954d7d3ad2?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MXwxMTc3M3wwfDF8c2VhcmNofDZ8fGNvZGV8ZW58MHx8fA&ixlib=rb-1.2.1&q=80&w=2000",
        "width": 2000,
        "height": 1306
    },
    "keywords": "YQL, Scraping, Data",
    "description": "YQL (Yahoo Query Language) allows you to do amazing things, and has many feeds for a developer to play with. Explore how we use it in Peak Stocks!",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "//wdziemia.github.io/"
    }
}
    </script>

    <meta name="generator" content="Ghost 3.40">
    <link rel="alternate" type="application/rss+xml" title="Wojciech Dziemianczyk" href="../rss/index.rss">

</head>
<body class="is-preload post-template tag-yql tag-scraping tag-data">

    <div id="wrapper">
        <main id="main">
            <div class="inner">

                
<section>

    <header class="main content">
        <span class="date">March 21, 2013</span>
        <h1>Scraping a Feature Together</h1>
            <p class="content">YQL (Yahoo Query Language) allows you to do amazing things, and has many feeds for a developer to play with. Explore how we use it in Peak Stocks!</p>
    </header>

    <div class="image main"><img src="https://images.unsplash.com/photo-1516259762381-22954d7d3ad2?crop=entropy&amp;cs=tinysrgb&amp;fit=max&amp;fm=jpg&amp;ixid=MXwxMTc3M3wwfDF8c2VhcmNofDZ8fGNvZGV8ZW58MHx8fA&amp;ixlib=rb-1.2.1&amp;q=80&amp;w=2000" alt="Scraping a Feature Together"></div>

    <div class="content">
        <p>YQL (<a href="https://en.wikipedia.org/wiki/Yahoo!_Query_Language">Yahoo Query Language</a>) allows you to do amazing things, and has many feeds for a developer to play with. In Peak Stocks, we use it for Option Chains and it works beautifully. An additional feature that we'd thought of was expanding social media feeds. We've gotten a lot of requests for twitter and thought, why not the yahoo message boards too? This is where YQL comes into play. </p><p>YQL has community tables, which aren't actual SQL tables. These "tables" are just XML files that scrape pages or using existing feeds and return a response object that is formatted to your liking. Within YQL console, these XML files are passed off a tables making it seem like your actually accessing a database. Anyway, the community tables allow anyone to create their own custom table, be it through the methods mentioned earlier. The finance message boards dont have an open API so i had to use the page scraping method. Having not a lick of experience in doing any of this, it took me a couple of hours to get it going, with countless attempts of trial and error (view the commit history, you'll see). Once i finally got some data to work with, it got easier and easier. The final XML file can be found on my GitHub <a href="https://www.blogger.com/u/1/blog/post/edit/575225956679068977/6613830476794116182#">here</a>. </p><p>The structure of the JavaScript is very simple, its a try-catch block and 2 methods. One method gets the next-page URL and the other loops through the <code>&lt;tr&gt;</code> elements within <code>&lt;tbody&gt;</code> and appends the rows to a <code>&lt;messages&gt;</code> element. </p><figure class="kg-card kg-code-card"><pre><code class="language-JSON">{
    "query": {
        "count": 1,
        "created": "2013-03-20T22:48:092",
        "lang": "en-US",
        "results": {
            "result": {
                "base_url": "//finance.yahoo.com",
                "next_page": "/mb/forumview/?&amp;bn=12b865d6-8061-30c4-86c1l-40adf7076aee&amp;page=3",
                "size": "20",
                "symbol": "GOOG",
                "message_board": {
                    "messages": [
                        {
                            "title": "SHORT THIS MONSTER BUBBLEEEEEEEEEEEEEE INTOOOOO THE GROUNDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD...",
                            "link": "/mbview/threadview/?&amp;bn=12b865d6-8061-30c4-86c1-40adf7076aee&amp;tid=1363805153334-73fc3ece-f9cd-4819-b5b6-d9cc206bc590&amp;t1ls=lat2Cdt2C20%2C3",
                            "published": {
                                "time": "4 hours ago",
                                "user": "pharmaheroouu",
                                "user_link": "/mbview/userview/?&amp;u=pharmaheroouusébn=12b865d6-8061-30c4-86c1-40adf7076aee"
                            },
                            "popularity": {
                                "up": "0",
                                "down": "0"
                            },
                            "replies": {
                                "count": "1",
                                "last_date": "4 hours ago",
                                "last_user": "pharmaheroouu",
                                "last_user_link": "/mbview/userview/?&amp;u=pharmaheroouvébn=12b865d6-8061-30c4-86c1-40adf7076aee"
                            }
                        }
                    ]
                }
            }
        }
    }
}</code></pre><figcaption>Output for <code>GOOG</code></figcaption></figure><p>Within the YQL console, you can have two YQL queries to choose from:</p><figure class="kg-card kg-code-card"><pre><code class="language-SQL">SELECT * FROM messageboard WHERE symbol='GOOG';</code></pre><figcaption>Most basic YQL, giving you page 1 of the message board.</figcaption></figure><figure class="kg-card kg-code-card"><pre><code class="language-SQL">SELECT * FROM messageboard WHERE symbol='GOOG' AND page=$LINK;</code></pre><figcaption>Additional query allows you to pick which page you'd like. The page value is given in the initial URL request as <code>link</code></figcaption></figure><p>As it stands, the file only parses through the a message board for a particular stock, getting all the threads within it. While it does provide you the the thread link, there is no way to get a feed for that individual thread.....yet. <br><br>The next step is to create another file that handles an individual thread. This shouldn't be difficult since I have experience from creating this one. </p>
    </div>


    <footer class="post-footer">
        <div><a href="//twitter.com/wdziemia">— @wdziemia</a></div>
    </footer>
    
    

    


</section>

<script>
    var images = document.querySelectorAll('.kg-gallery-image img');
    images.forEach(function (image) {
        var container = image.closest('.kg-gallery-image');
        var width = image.attributes.width.value;
        var height = image.attributes.height.value;
        var ratio = width / height;
        container.style.flex = ratio + ' 1 0%';
    })
</script>


            </div>
        </main>

        <div id="sidebar">
    <div class="inner">

              
                <section class="author-header">
                        <img class="author-profile-image" src="../content/images/2020/12/3921079.jpeg" alt="Walter Dziemianczyk">
                    <h3>Walter Dziemianczyk</h3>       
                    <div>Senior Software Engineer<br>New York, New York</div>

                </section>
            

            <nav id="menu">
    <header class="major">
        <h2>Menu</h2>
    </header>
    <ul class="links">
        <li class="nav-home "><a href="../index.html">Home</a></li>
    </ul>
</nav>

        <section id="menu">
            <header class="major">
                <h2>Links</h2>
            </header>
            <ul class="links">
                <li><a href="https://github.com/wdziemia">Github</a></li>
                <li><a href="https://www.linkedin.com/in/walter-dziemianczyk-3308035b/">LinkedIn</a></li>
                <li><a href="https://twitter.com/wdziemia">Twitter</a></li>
                <li><a href="https://feedly.com/i/subscription/feed///wdziemia.github.io/rss/index.rss">Linkify</a></li>
            </ul>
        </section>

        <section id="menu">
            <header class="major">
                <h2>Projects</h2>
            </header>
            <ul class="links">
                <li><a href="https://window.dziemia.com">Window VQA</a></li>
                <li><a href="https://github.com/wdziemia/wdziemia.github.io">Blog</a></li>
            </ul>
        </section>

        <footer id="footer">
            <p class="copyright">© 2020 Wojciech Dziemianczyk
        </p></footer>

    </div>
</div>

    </div>

    <script src="../assets/main/js/jquery.min.js?v=fc55173e29"></script>
    <script src="../assets/main/js/browser.min.js?v=fc55173e29"></script>
    <script src="../assets/main/js/breakpoints.min.js?v=fc55173e29"></script>
    <script src="../assets/main/js/util.js?v=fc55173e29"></script>
    <script src="../assets/main/js/main.js?v=fc55173e29"></script>
    <script src="../assets/main/js/prism.js?v=fc55173e29"></script>

    

</body>
</html>